<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Embedded Rust Programming on WSL (RISC-V) | michaelpeters</title><meta name=keywords content="wsl,rust,risc-v"><meta name=description content="Image Courtesy of SiFive, Inc.
I recently picked up the SiFive HiFive 1 Rev B RISC-V microcontroller on Crowd Supply. According to the SiFive product page, the HiFive 1 Rev B is &ldquo;an Arduino-compatible development board featuring the SiFive Freedom E310-G002 (FE310-G002) SoC plus a ESP32-SOLO-1 Wi-Fi and Bluetooth module&rdquo;. I have seen examples for this board written in C, Rust, and TinyGo. Having not used Rust as much as I would like, I wanted to start there for development on this platform."><meta name=author content="michaelpeterswa"><link rel=canonical href=https://michaelpeters.dev/posts/embedded-rust-programming-on-wsl/><link crossorigin=anonymous href=/assets/css/stylesheet.min.6f60056d44d3f7eb69a4bc6c332b59960f3a995802bded244750232f33713c49.css integrity="sha256-b2AFbUTT9+tppLxsMytZlg86mVgCve0kR1AjLzNxPEk=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://michaelpeters.dev/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://michaelpeters.dev/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://michaelpeters.dev/favicon-32x32.png><link rel=apple-touch-icon href=https://michaelpeters.dev/apple-touch-icon.png><link rel=mask-icon href=https://michaelpeters.dev/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.110.0"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Embedded Rust Programming on WSL (RISC-V)"><meta property="og:description" content="Image Courtesy of SiFive, Inc.
I recently picked up the SiFive HiFive 1 Rev B RISC-V microcontroller on Crowd Supply. According to the SiFive product page, the HiFive 1 Rev B is &ldquo;an Arduino-compatible development board featuring the SiFive Freedom E310-G002 (FE310-G002) SoC plus a ESP32-SOLO-1 Wi-Fi and Bluetooth module&rdquo;. I have seen examples for this board written in C, Rust, and TinyGo. Having not used Rust as much as I would like, I wanted to start there for development on this platform."><meta property="og:type" content="article"><meta property="og:url" content="https://michaelpeters.dev/posts/embedded-rust-programming-on-wsl/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-14T20:31:04-08:00"><meta property="article:modified_time" content="2023-02-14T20:31:04-08:00"><meta property="og:site_name" content="michaelpeters"><meta name=twitter:card content="summary"><meta name=twitter:title content="Embedded Rust Programming on WSL (RISC-V)"><meta name=twitter:description content="Image Courtesy of SiFive, Inc.
I recently picked up the SiFive HiFive 1 Rev B RISC-V microcontroller on Crowd Supply. According to the SiFive product page, the HiFive 1 Rev B is &ldquo;an Arduino-compatible development board featuring the SiFive Freedom E310-G002 (FE310-G002) SoC plus a ESP32-SOLO-1 Wi-Fi and Bluetooth module&rdquo;. I have seen examples for this board written in C, Rust, and TinyGo. Having not used Rust as much as I would like, I wanted to start there for development on this platform."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://michaelpeters.dev/posts/"},{"@type":"ListItem","position":2,"name":"Embedded Rust Programming on WSL (RISC-V)","item":"https://michaelpeters.dev/posts/embedded-rust-programming-on-wsl/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Embedded Rust Programming on WSL (RISC-V)","name":"Embedded Rust Programming on WSL (RISC-V)","description":"Image Courtesy of SiFive, Inc.\nI recently picked up the SiFive HiFive 1 Rev B RISC-V microcontroller on Crowd Supply. According to the SiFive product page, the HiFive 1 Rev B is \u0026ldquo;an Arduino-compatible development board featuring the SiFive Freedom E310-G002 (FE310-G002) SoC plus a ESP32-SOLO-1 Wi-Fi and Bluetooth module\u0026rdquo;. I have seen examples for this board written in C, Rust, and TinyGo. Having not used Rust as much as I would like, I wanted to start there for development on this platform.","keywords":["wsl","rust","risc-v"],"articleBody":" Image Courtesy of SiFive, Inc.\nI recently picked up the SiFive HiFive 1 Rev B RISC-V microcontroller on Crowd Supply. According to the SiFive product page, the HiFive 1 Rev B is “an Arduino-compatible development board featuring the SiFive Freedom E310-G002 (FE310-G002) SoC plus a ESP32-SOLO-1 Wi-Fi and Bluetooth module”. I have seen examples for this board written in C, Rust, and TinyGo. Having not used Rust as much as I would like, I wanted to start there for development on this platform. Here is a thorough write-up of the process on Windows 11 via Windows Subsystem for Linux (February 2023).\nProcess This post assumes that you already have a properly configured (basic) Ubuntu 20.04 WSL install. Installation of Ubuntu on WSL is out of the scope of this post, although more information can be found here\nPrepare WSL for USB Devices Following the provided Microsoft Documentation, the first step to prepare WSL for USB is to run the following commands:\nsudo apt install linux-tools-5.4.0-77-generic hwdata sudo update-alternatives --install /usr/local/bin/usbip usbip /usr/lib/linux-tools/5.4.0-77-generic/usbip 20 Once complete, it’s important to ensure you have USB devices available on the host Windows 11 machine to passthrough. That can be accomplished with the following command (run in Powershell as Administrator):\nusbipd wsl list If an error is encountered stating that the usbipd cmdlet cannot be found (or anything similar), my first suggestion would be to update WSL (older versions of WSL didn’t have USB support). That can be done with two commands (again in an Administrator Powershell).\nwsl --update wsl --shutdown Once you are able to verify that you have devices available, we can continue to attaching the USB device to a WSL instance.\nIt should look something like this:\nPS C:\\WINDOWS\\system32\u003e usbipd wsl list BUSID VID:PID DEVICE STATE 1-10 0b05:185c Realtek Bluetooth Adapter attached 1-12 1366:1061 JLink CDC UART Port (COM9), JLink CDC UART Port (COM8), B... Not attached Attaching a USB Device to WSL Our SiFive HiFive 1 Rev B uses a SEGGER JLink integration to communicate with the computer. We can see above that our board has a BUSID of 1-12. We will need to note that for a future step.\nNext, we want to identify the active distributions for WSL that we have on our computer. There is a set of WSL flags that can help us with this. (again in an Administrator Powershell)\nwsl --list --verbose For this post, we will be using the name Ubuntu-20.04.\nTo attach the USB device to our WSL instance, issue the following command (matching the two flags to the values we found above):\nusbipd wsl attach --busid 1-12 --distribution Ubuntu-20.04 Installing the JLink software on our WSL VM Some trickery is needed to download the JLink package from their website programatically. To accept the license agreement, download, and install the .deb package (explicitly for x86_64 architectures), run the following:\ncurl 'https://www.segger.com/downloads/jlink/JLink_Linux_V784f_x86_64.deb' --data-raw 'accept_license_agreement=accepted\u0026submit=Download+software' --output JLink_Linux_x86_64.deb sudo dpkg -i JLink_Linux_x86_64.deb sudo apt-get -f install Installing Rust via Rustup rustup is the installer for the Rust Programming Language. For WSL, installation is managed with the following command:\ncurl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh You will need to select the default install for the purposes of this post. I ended up with this version: rustc 1.67.1\nInstalling cargo-generate To install cargo-generate, run the next command:\ncargo install cargo-generate Installing RISC-V Compilation Target To use our board, we will need a special compilation target. To install it:\nrustup target add riscv32imac-unknown-none-elf Installing SiFive GNU Toolchain for RISC-V To install the toolchain, we will need to download and unpack a file from the SiFive website. It’s no longer accessible (via their site) to my knowledge, but a direct link to their download server still works as of February 2023.\nThe last chmod may or may not be optional… I didn’t bother to check.\ncurl https://static.dev.sifive.com/dev-tools/freedom-tools/v2020.12/riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14.tar.gz --output /home/{your username}/riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14.tar.gz tar -xvf /home/{your username}/riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14.tar.gz chmod +x /home/{your username}/riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14/bin/riscv64-unknown-elf-gdb Then, add the following to your $PATH in .bashrc:\nexport PATH=\"$PATH:/home/{your username}/riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14/bin\" Starting the JLink GDB Server Starting the GDB server at this point is a fairly straightforward process. Just one command:\nJLinkGDBServer -device FE310 -if JTAG -speed 4000 -port 3333 -nogui Building and Deploying the Example Rust Code First, we need to instantiate the new application:\ncargo generate --git https://github.com/riscv-rust/riscv-rust-quickstart After naming the app, enter the new app’s directory:\ncd {app name} In the Cargo.toml file, I needed to make one adjustment. I bumped the dependency riscv-rt to 0.11.0 from 0.10.0. My final dependencies looked like this:\n[dependencies] embedded-hal = \"0.2.7\" hifive1 = { version = \"0.10.0\", features = [\"board-hifive1-revb\"] } panic-halt = \"0.2.0\" riscv = \"0.10.0\" riscv-rt = \"0.11.0\" To run the LED Blink example, two final commands will be needed:\ncargo build --example leds_blink cargo run --example leds_blink Additionally, to view the serial console, you may try the following command:\nsudo screen /dev/ttyACM0 115200 Final Thoughts I’m excited to try writing some of my own Rust code for the SiFive HiFive 1 Rev B here in the coming weeks. I was admittedly late to the party (this board was released in April 2019), but I still see value in getting into the RISC-V architecture, especially in such an approachable form factor. If you’d like to pick one up for yourself, check out the Crowd Supply page!\nLinks for Future Research University of Kansas EECS 388 Lab #1 UK EECS 388 Schedule The Embedded Rust Book ","wordCount":"897","inLanguage":"en","datePublished":"2023-02-14T20:31:04-08:00","dateModified":"2023-02-14T20:31:04-08:00","author":{"@type":"Person","name":"michaelpeterswa"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://michaelpeters.dev/posts/embedded-rust-programming-on-wsl/"},"publisher":{"@type":"Organization","name":"michaelpeters","logo":{"@type":"ImageObject","url":"https://michaelpeters.dev/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://michaelpeters.dev/ accesskey=h title="michaelpeters (Alt + H)">michaelpeters</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://michaelpeters.dev/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://michaelpeters.dev/>Home</a>&nbsp;»&nbsp;<a href=https://michaelpeters.dev/posts/>Posts</a></div><h1 class=post-title>Embedded Rust Programming on WSL (RISC-V)</h1><div class=post-meta><span title='2023-02-14 20:31:04 -0800 -0800'>February 14, 2023</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;michaelpeterswa&nbsp;|&nbsp;<a href=https://github.com/michaelpeterswa/blog/blob/main/content/posts/embedded-rust-programming-on-wsl.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p><img loading=lazy src="https://images.prismic.io/sifive/3ea0c69619fcf3f16db9f8c85514a89a4f2d9d00_boards_hifive1.jpg?auto=compress,format#center" alt="SiFive HiFive1 RevB (discontinued)">
Image Courtesy of <a href=https://www.sifive.com/>SiFive, Inc.</a></p><p>I recently picked up the SiFive HiFive 1 Rev B RISC-V microcontroller on <a href=https://www.crowdsupply.com/sifive/hifive1-rev-b>Crowd Supply</a>. According to the SiFive product page, the HiFive 1 Rev B is &ldquo;an Arduino-compatible development board featuring the SiFive Freedom E310-G002 (FE310-G002) SoC plus a ESP32-SOLO-1 Wi-Fi and Bluetooth module&rdquo;. I have seen examples for this board written in C, Rust, and TinyGo. Having not used Rust as much as I would like, I wanted to start there for development on this platform. Here is a thorough write-up of the process on Windows 11 via Windows Subsystem for Linux (February 2023).</p><h2 id=process>Process<a hidden class=anchor aria-hidden=true href=#process>#</a></h2><p>This post assumes that you already have a properly configured (basic) Ubuntu 20.04 WSL install. Installation of Ubuntu on WSL is out of the scope of this post, although more information can be found <a href=https://ubuntu.com/tutorials/install-ubuntu-on-wsl2-on-windows-10#1-overview>here</a></p><h3 id=prepare-wsl-for-usb-devices>Prepare WSL for USB Devices<a hidden class=anchor aria-hidden=true href=#prepare-wsl-for-usb-devices>#</a></h3><p>Following the provided <a href=https://learn.microsoft.com/en-us/windows/wsl/connect-usb>Microsoft Documentation</a>, the first step to prepare WSL for USB is to run the following commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install linux-tools-5.4.0-77-generic hwdata
</span></span><span style=display:flex><span>sudo update-alternatives --install /usr/local/bin/usbip usbip /usr/lib/linux-tools/5.4.0-77-generic/usbip <span style=color:#ae81ff>20</span>
</span></span></code></pre></div><p>Once complete, it&rsquo;s important to ensure you have USB devices available on the host Windows 11 machine to passthrough. That can be accomplished with the following command (run in Powershell as Administrator):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>usbipd wsl list
</span></span></code></pre></div><p>If an error is encountered stating that the <code>usbipd</code> cmdlet cannot be found (or anything similar), my first suggestion would be to update WSL (older versions of WSL didn&rsquo;t have USB support). That can be done with two commands (again in an Administrator Powershell).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>wsl --update
</span></span><span style=display:flex><span>wsl --shutdown
</span></span></code></pre></div><p>Once you are able to verify that you have devices available, we can continue to attaching the USB device to a WSL instance.</p><p>It should look something like this:</p><pre tabindex=0><code>PS C:\WINDOWS\system32&gt; usbipd wsl list
BUSID  VID:PID    DEVICE                    STATE
1-10   0b05:185c  Realtek Bluetooth Adapter attached
1-12   1366:1061  JLink CDC UART Port (COM9), JLink CDC UART Port (COM8), B... Not attached
</code></pre><h3 id=attaching-a-usb-device-to-wsl>Attaching a USB Device to WSL<a hidden class=anchor aria-hidden=true href=#attaching-a-usb-device-to-wsl>#</a></h3><p>Our SiFive HiFive 1 Rev B uses a SEGGER JLink integration to communicate with the computer. We can see above that our board has a <code>BUSID</code> of <code>1-12</code>. We will need to note that for a future step.</p><p>Next, we want to identify the active distributions for WSL that we have on our computer. There is a set of WSL flags that can help us with this. (again in an Administrator Powershell)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>wsl --list --verbose
</span></span></code></pre></div><p>For this post, we will be using the name <code>Ubuntu-20.04</code>.</p><p>To attach the USB device to our WSL instance, issue the following command (matching the two flags to the values we found above):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>usbipd wsl attach --busid <span style=color:#ae81ff>1</span>-<span style=color:#ae81ff>12</span> --distribution Ubuntu-<span style=color:#ae81ff>20.04</span>
</span></span></code></pre></div><h3 id=installing-the-jlink-software-on-our-wsl-vm>Installing the JLink software on our WSL VM<a hidden class=anchor aria-hidden=true href=#installing-the-jlink-software-on-our-wsl-vm>#</a></h3><p>Some trickery is needed to download the JLink package from their website programatically. To accept the license agreement, download, and install the <code>.deb</code> package (explicitly for <code>x86_64</code> architectures), run the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl <span style=color:#e6db74>&#39;https://www.segger.com/downloads/jlink/JLink_Linux_V784f_x86_64.deb&#39;</span> --data-raw <span style=color:#e6db74>&#39;accept_license_agreement=accepted&amp;submit=Download+software&#39;</span> --output JLink_Linux_x86_64.deb
</span></span><span style=display:flex><span>sudo dpkg -i JLink_Linux_x86_64.deb
</span></span><span style=display:flex><span>sudo apt-get -f install
</span></span></code></pre></div><h3 id=installing-rust-via-rustup>Installing Rust via Rustup<a hidden class=anchor aria-hidden=true href=#installing-rust-via-rustup>#</a></h3><p><code>rustup</code> is the installer for the Rust Programming Language. For WSL, installation is managed with the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl --proto <span style=color:#e6db74>&#39;=https&#39;</span> --tlsv1.2 -sSf https://sh.rustup.rs | sh
</span></span></code></pre></div><p>You will need to select the default install for the purposes of this post. I ended up with this version: <code>rustc 1.67.1</code></p><h3 id=installing-cargo-generate>Installing cargo-generate<a hidden class=anchor aria-hidden=true href=#installing-cargo-generate>#</a></h3><p>To install <code>cargo-generate</code>, run the next command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cargo install cargo-generate
</span></span></code></pre></div><h3 id=installing-risc-v-compilation-target>Installing RISC-V Compilation Target<a hidden class=anchor aria-hidden=true href=#installing-risc-v-compilation-target>#</a></h3><p>To use our board, we will need a special compilation target. To install it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rustup target add riscv32imac-unknown-none-elf
</span></span></code></pre></div><h3 id=installing-sifive-gnu-toolchain-for-risc-v>Installing SiFive GNU Toolchain for RISC-V<a hidden class=anchor aria-hidden=true href=#installing-sifive-gnu-toolchain-for-risc-v>#</a></h3><p>To install the toolchain, we will need to download and unpack a file from the SiFive website. It&rsquo;s no longer accessible (via their site) to my knowledge, but a direct link to their download server still works as of February 2023.</p><p>The last <code>chmod</code> may or may not be optional&mldr; I didn&rsquo;t bother to check.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl https://static.dev.sifive.com/dev-tools/freedom-tools/v2020.12/riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14.tar.gz --output /home/<span style=color:#f92672>{</span>your username<span style=color:#f92672>}</span>/riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14.tar.gz
</span></span><span style=display:flex><span>tar -xvf /home/<span style=color:#f92672>{</span>your username<span style=color:#f92672>}</span>/riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14.tar.gz
</span></span><span style=display:flex><span>chmod +x /home/<span style=color:#f92672>{</span>your username<span style=color:#f92672>}</span>/riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14/bin/riscv64-unknown-elf-gdb
</span></span></code></pre></div><p>Then, add the following to your <code>$PATH</code> in <code>.bashrc</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$PATH<span style=color:#e6db74>:/home/{your username}/riscv64-unknown-elf-toolchain-10.2.0-2020.12.8-x86_64-linux-ubuntu14/bin&#34;</span>
</span></span></code></pre></div><h3 id=starting-the-jlink-gdb-server>Starting the JLink GDB Server<a hidden class=anchor aria-hidden=true href=#starting-the-jlink-gdb-server>#</a></h3><p>Starting the GDB server at this point is a fairly straightforward process. Just one command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>JLinkGDBServer -device FE310 -if JTAG -speed <span style=color:#ae81ff>4000</span> -port <span style=color:#ae81ff>3333</span> -nogui
</span></span></code></pre></div><h3 id=building-and-deploying-the-example-rust-code>Building and Deploying the Example Rust Code<a hidden class=anchor aria-hidden=true href=#building-and-deploying-the-example-rust-code>#</a></h3><p>First, we need to instantiate the new application:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cargo generate --git https://github.com/riscv-rust/riscv-rust-quickstart
</span></span></code></pre></div><p>After naming the app, enter the new app&rsquo;s directory:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd <span style=color:#f92672>{</span>app name<span style=color:#f92672>}</span>
</span></span></code></pre></div><p>In the <code>Cargo.toml</code> file, I needed to make one adjustment. I bumped the dependency <code>riscv-rt</code> to <code>0.11.0</code> from <code>0.10.0</code>. My final dependencies looked like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span>[<span style=color:#a6e22e>dependencies</span>]
</span></span><span style=display:flex><span><span style=color:#a6e22e>embedded-hal</span> = <span style=color:#e6db74>&#34;0.2.7&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>hifive1</span> = { <span style=color:#a6e22e>version</span> = <span style=color:#e6db74>&#34;0.10.0&#34;</span>, <span style=color:#a6e22e>features</span> = [<span style=color:#e6db74>&#34;board-hifive1-revb&#34;</span>] }
</span></span><span style=display:flex><span><span style=color:#a6e22e>panic-halt</span> = <span style=color:#e6db74>&#34;0.2.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>riscv</span> = <span style=color:#e6db74>&#34;0.10.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>riscv-rt</span> = <span style=color:#e6db74>&#34;0.11.0&#34;</span>
</span></span></code></pre></div><p>To run the LED Blink example, two final commands will be needed:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cargo build --example leds_blink
</span></span><span style=display:flex><span>cargo run --example leds_blink
</span></span></code></pre></div><p>Additionally, to view the serial console, you may try the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo screen /dev/ttyACM0 <span style=color:#ae81ff>115200</span>
</span></span></code></pre></div><h3 id=final-thoughts>Final Thoughts<a hidden class=anchor aria-hidden=true href=#final-thoughts>#</a></h3><p>I&rsquo;m excited to try writing some of my own Rust code for the SiFive HiFive 1 Rev B here in the coming weeks. I was admittedly late to the party (this board was released in April 2019), but I still see value in getting into the RISC-V architecture, especially in such an approachable form factor. If you&rsquo;d like to pick one up for yourself, check out the <a href=https://www.crowdsupply.com/sifive/hifive1-rev-b>Crowd Supply</a> page!</p><h3 id=links-for-future-research>Links for Future Research<a hidden class=anchor aria-hidden=true href=#links-for-future-research>#</a></h3><ul><li><a href=https://www.ittc.ku.edu/~heechul/courses/eecs388/lab1.pdf>University of Kansas EECS 388 Lab #1</a><ul><li><a href=http://www.ittc.ku.edu/~heechul/courses/eecs388/schedule.html>UK EECS 388 Schedule</a></li></ul></li><li><a href=https://docs.rust-embedded.org/book/>The Embedded Rust Book</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://michaelpeters.dev/tags/wsl/>wsl</a></li><li><a href=https://michaelpeters.dev/tags/rust/>rust</a></li><li><a href=https://michaelpeters.dev/tags/risc-v/>risc-v</a></li></ul><nav class=paginav><a class=next href=https://michaelpeters.dev/posts/leveraging-external-tables-in-google-big-query/><span class=title>Next Page »</span><br><span>Leveraging External Tables in Google BigQuery</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Embedded Rust Programming on WSL (RISC-V) on twitter" href="https://twitter.com/intent/tweet/?text=Embedded%20Rust%20Programming%20on%20WSL%20%28RISC-V%29&url=https%3a%2f%2fmichaelpeters.dev%2fposts%2fembedded-rust-programming-on-wsl%2f&hashtags=wsl%2crust%2crisc-v"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Embedded Rust Programming on WSL (RISC-V) on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fmichaelpeters.dev%2fposts%2fembedded-rust-programming-on-wsl%2f&title=Embedded%20Rust%20Programming%20on%20WSL%20%28RISC-V%29&summary=Embedded%20Rust%20Programming%20on%20WSL%20%28RISC-V%29&source=https%3a%2f%2fmichaelpeters.dev%2fposts%2fembedded-rust-programming-on-wsl%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Embedded Rust Programming on WSL (RISC-V) on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fmichaelpeters.dev%2fposts%2fembedded-rust-programming-on-wsl%2f&title=Embedded%20Rust%20Programming%20on%20WSL%20%28RISC-V%29"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Embedded Rust Programming on WSL (RISC-V) on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fmichaelpeters.dev%2fposts%2fembedded-rust-programming-on-wsl%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Embedded Rust Programming on WSL (RISC-V) on whatsapp" href="https://api.whatsapp.com/send?text=Embedded%20Rust%20Programming%20on%20WSL%20%28RISC-V%29%20-%20https%3a%2f%2fmichaelpeters.dev%2fposts%2fembedded-rust-programming-on-wsl%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Embedded Rust Programming on WSL (RISC-V) on telegram" href="https://telegram.me/share/url?text=Embedded%20Rust%20Programming%20on%20WSL%20%28RISC-V%29&url=https%3a%2f%2fmichaelpeters.dev%2fposts%2fembedded-rust-programming-on-wsl%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://michaelpeters.dev/>michaelpeters</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>